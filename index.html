<!DOCTYPE html>
<html>
<head>
  <title>Neuron AI</title>
  <style>
    body { font-family: monospace; background:#111; color:#0f0; padding:20px; }
    input { width:80%; background:black; color:#0f0; border:1px solid #0f0; }
    button { background:black; color:#0f0; border:1px solid #0f0; }
  </style>
</head>
<body>
<h2>Neuron AI (No API)</h2>
<div id="chat"></div>
<input id="input" placeholder="type here">
<button onclick="send()">Send</button>

<script>
const data = [
  ["hello", "print('Hello world')"],
  ["loop", "for i in range(5): print(i)"],
  ["if", "if x == 3: print('yes')"],
  ["function", "def myFunc(): pass"]
];

// build vocab
let vocab = new Set();
data.forEach(d => d[0].split("").forEach(c => vocab.add(c)));
vocab = Array.from(vocab);
const map = Object.fromEntries(vocab.map((c,i)=>[c,i]));

function encode(text){
  let x = new Array(vocab.length).fill(0);
  for(let c of text){
    if(map[c] !== undefined) x[map[c]]++;
  }
  return x;
}

// neural net
let inputSize = vocab.length;
let hiddenSize = 16;
let outputSize = data.length;

let w1 = Array.from({length:inputSize},()=>Array.from({length:hiddenSize},()=>Math.random()*0.01));
let b1 = new Array(hiddenSize).fill(0);
let w2 = Array.from({length:hiddenSize},()=>Array.from({length:outputSize},()=>Math.random()*0.01));
let b2 = new Array(outputSize).fill(0);

function relu(x){ return x.map(v=>Math.max(0,v)); }
function softmax(x){
  let m = Math.max(...x);
  let ex = x.map(v=>Math.exp(v-m));
  let sum = ex.reduce((a,b)=>a+b,0);
  return ex.map(v=>v/sum);
}

function forward(x){
  let h = b1.map((v,j)=>v + x.reduce((s,xi,i)=>s+xi*w1[i][j],0));
  h = relu(h);
  let o = b2.map((v,j)=>v + h.reduce((s,hi,i)=>s+hi*w2[i][j],0));
  return softmax(o);
}

// train
for(let e=0;e<2000;e++){
  for(let i=0;i<data.length;i++){
    let x = encode(data[i][0]);
    let y = Array(outputSize).fill(0); y[i]=1;
    let out = forward(x);
    let err = out.map((v,j)=>v-y[j]);

    for(let j=0;j<hiddenSize;j++)
      for(let k=0;k<outputSize;k++)
        w2[j][k] -= 0.01*err[k];

    for(let j=0;j<inputSize;j++)
      for(let k=0;k<hiddenSize;k++)
        w1[j][k] -= 0.01*err.reduce((s,e,i)=>s+e*w2[k][i],0);
  }
}

function send(){
  let msg = input.value;
  let x = encode(msg);
  let out = forward(x);
  let i = out.indexOf(Math.max(...out));
  chat.innerHTML += "<div>You: "+msg+"</div>";
  chat.innerHTML += "<div>AI: "+data[i][1]+"</div>";
  input.value="";
}
</script>
</body>
</html>
